<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SponScore ‚Äî Company Search</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #080B14;
    --surface: #0E1220;
    --surface2: #141929;
    --accent: #4AFFA3;
    --accent2: #4A9FFF;
    --text: #F0F4FF;
    --muted: #6B7799;
    --border: rgba(255,255,255,0.07);
    --high: #4AFFA3;
    --med: #FFD166;
    --low: #FF6B6B;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }
  html { scroll-behavior: smooth; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 9999;
    opacity: 0.4;
  }

  /* NAV */
  nav {
    position: fixed;
    top: 0; left: 0; right: 0;
    z-index: 100;
    padding: 20px 48px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: rgba(8,11,20,0.85);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
  }

  .logo {
    font-family: 'Syne', sans-serif;
    font-weight: 800;
    font-size: 1.4rem;
    letter-spacing: -0.02em;
    color: var(--text);
    text-decoration: none;
  }

  .logo span { color: var(--accent); }

  nav ul {
    list-style: none;
    display: flex;
    gap: 36px;
    align-items: center;
  }

  nav ul a {
    color: var(--muted);
    text-decoration: none;
    font-size: 0.9rem;
    font-weight: 500;
    transition: color 0.2s;
  }

  nav ul a:hover { color: var(--text); }
  nav ul a.active { color: var(--accent); }

  .btn-nav {
    background: var(--accent);
    color: #080B14 !important;
    padding: 9px 20px;
    border-radius: 8px;
    font-weight: 600 !important;
    font-size: 0.85rem !important;
  }

  /* MAIN */
  main {
    padding: 120px 24px 80px;
    max-width: 800px;
    margin: 0 auto;
  }

  /* HERO */
  .search-hero {
    text-align: center;
    margin-bottom: 48px;
  }

  .search-hero .badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: rgba(74,255,163,0.1);
    border: 1px solid rgba(74,255,163,0.25);
    border-radius: 100px;
    padding: 6px 14px;
    font-size: 0.78rem;
    font-weight: 500;
    color: var(--accent);
    margin-bottom: 20px;
  }

  .search-hero h1 {
    font-family: 'Syne', sans-serif;
    font-size: clamp(2rem, 5vw, 3.2rem);
    font-weight: 800;
    letter-spacing: -0.03em;
    line-height: 1.1;
    margin-bottom: 12px;
  }

  .search-hero p {
    color: var(--muted);
    font-size: 1rem;
    line-height: 1.6;
  }

  /* SEARCH BOX */
  .search-box {
    position: relative;
    margin-bottom: 32px;
  }

  .search-input {
    width: 100%;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 18px 60px 18px 54px;
    color: var(--text);
    font-family: 'DM Sans', sans-serif;
    font-size: 1rem;
    font-weight: 400;
    outline: none;
    transition: border-color 0.2s, box-shadow 0.2s;
  }

  .search-input::placeholder { color: var(--muted); }

  .search-input:focus {
    border-color: rgba(74,255,163,0.4);
    box-shadow: 0 0 0 3px rgba(74,255,163,0.08);
  }

  .search-icon {
    position: absolute;
    left: 18px;
    top: 50%;
    transform: translateY(-50%);
    color: var(--muted);
    pointer-events: none;
  }

  .search-btn {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    background: var(--accent);
    color: #080B14;
    border: none;
    border-radius: 10px;
    padding: 10px 20px;
    font-family: 'DM Sans', sans-serif;
    font-size: 0.88rem;
    font-weight: 600;
    cursor: pointer;
    transition: opacity 0.2s, transform 0.15s;
  }

  .search-btn:hover { opacity: 0.85; transform: translateY(-50%) scale(1.02); }
  .search-btn:disabled { opacity: 0.5; cursor: not-allowed; }

  /* SUGGESTIONS */
  .suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 40px;
    justify-content: center;
  }

  .suggestion-pill {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 100px;
    padding: 6px 16px;
    font-size: 0.8rem;
    color: var(--muted);
    cursor: pointer;
    transition: all 0.2s;
  }

  .suggestion-pill:hover {
    border-color: rgba(74,255,163,0.3);
    color: var(--text);
    background: rgba(74,255,163,0.05);
  }

  /* STATES */
  .state { display: none; }
  .state.active { display: block; }

  /* LOADING */
  .loading {
    text-align: center;
    padding: 60px 0;
  }

  .spinner {
    width: 40px; height: 40px;
    border: 2px solid var(--border);
    border-top-color: var(--accent);
    border-radius: 50%;
    animation: spin 0.7s linear infinite;
    margin: 0 auto 16px;
  }

  @keyframes spin { to { transform: rotate(360deg); } }

  .loading p {
    color: var(--muted);
    font-size: 0.88rem;
  }

  /* RESULT */
  .result-card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    overflow: hidden;
    animation: fadeUp 0.4s ease both;
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .result-header {
    padding: 28px 28px 20px;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 16px;
  }

  .company-avatar {
    width: 52px; height: 52px;
    border-radius: 14px;
    background: rgba(74,255,163,0.1);
    border: 1px solid rgba(74,255,163,0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: 'Syne', sans-serif;
    font-weight: 800;
    font-size: 1.4rem;
    color: var(--accent);
    flex-shrink: 0;
    text-transform: uppercase;
  }

  .company-info {}

  .company-name {
    font-family: 'Syne', sans-serif;
    font-size: 1.4rem;
    font-weight: 800;
    letter-spacing: -0.02em;
    text-transform: capitalize;
  }

  .company-match {
    font-size: 0.78rem;
    color: var(--muted);
    margin-top: 3px;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  .company-match .check { color: var(--accent); }

  /* SCORES GRID */
  .scores-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background: var(--border);
  }

  .score-block {
    background: var(--surface);
    padding: 24px 28px;
    position: relative;
    overflow: hidden;
  }

  .score-block::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 2px;
  }

  .score-block.h1b::before { background: linear-gradient(90deg, var(--accent2), transparent); }
  .score-block.opt::before { background: linear-gradient(90deg, var(--accent), transparent); }

  .score-block-label {
    font-size: 0.72rem;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 10px;
  }

  .score-number {
    font-family: 'Syne', sans-serif;
    font-size: 3rem;
    font-weight: 800;
    letter-spacing: -0.04em;
    line-height: 1;
    margin-bottom: 10px;
  }

  .score-number.high { color: var(--high); }
  .score-number.med { color: var(--med); }
  .score-number.low { color: var(--low); }

  .tier-badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    border-radius: 100px;
    padding: 4px 12px;
    font-size: 0.75rem;
    font-weight: 600;
  }

  .tier-badge.high { background: rgba(74,255,163,0.1); color: var(--high); border: 1px solid rgba(74,255,163,0.2); }
  .tier-badge.med { background: rgba(255,209,102,0.1); color: var(--med); border: 1px solid rgba(255,209,102,0.2); }
  .tier-badge.low { background: rgba(255,107,107,0.1); color: var(--low); border: 1px solid rgba(255,107,107,0.2); }

  /* WORKERS */
  .workers-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1px;
    background: var(--border);
    border-top: 1px solid var(--border);
  }

  .worker-block {
    background: var(--surface2);
    padding: 20px 28px;
  }

  .worker-label {
    font-size: 0.72rem;
    font-weight: 600;
    letter-spacing: 0.1em;
    text-transform: uppercase;
    color: var(--muted);
    margin-bottom: 6px;
  }

  .worker-value {
    font-family: 'Syne', sans-serif;
    font-size: 1.6rem;
    font-weight: 800;
    letter-spacing: -0.02em;
    color: var(--text);
  }

  .worker-value span {
    font-size: 0.75rem;
    color: var(--muted);
    font-family: 'DM Sans', sans-serif;
    font-weight: 400;
    margin-left: 3px;
  }

  /* NOT FOUND */
  .not-found {
    text-align: center;
    padding: 60px 24px;
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 20px;
    animation: fadeUp 0.4s ease both;
  }

  .not-found .icon { font-size: 2.5rem; margin-bottom: 14px; }

  .not-found h3 {
    font-family: 'Syne', sans-serif;
    font-size: 1.2rem;
    font-weight: 700;
    margin-bottom: 8px;
  }

  .not-found p {
    color: var(--muted);
    font-size: 0.88rem;
    line-height: 1.6;
    max-width: 360px;
    margin: 0 auto;
  }

  /* ERROR */
  .error-state {
    text-align: center;
    padding: 60px 24px;
    background: var(--surface);
    border: 1px solid rgba(255,107,107,0.15);
    border-radius: 20px;
    animation: fadeUp 0.4s ease both;
  }

  .error-state .icon { font-size: 2.5rem; margin-bottom: 14px; }

  .error-state h3 {
    font-family: 'Syne', sans-serif;
    font-size: 1.2rem;
    font-weight: 700;
    margin-bottom: 8px;
    color: var(--low);
  }

  .error-state p {
    color: var(--muted);
    font-size: 0.88rem;
    line-height: 1.6;
  }

  /* FOOTER */
  footer {
    padding: 32px 48px;
    border-top: 1px solid var(--border);
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 16px;
    margin-top: 60px;
  }

  footer p { font-size: 0.82rem; color: var(--muted); }
  footer a { color: var(--muted); text-decoration: none; font-size: 0.82rem; transition: color 0.2s; }
  footer a:hover { color: var(--text); }

  @media (max-width: 600px) {
    nav { padding: 16px 20px; }
    nav ul { display: none; }
    main { padding: 100px 16px 60px; }
    .scores-grid { grid-template-columns: 1fr; }
    .workers-grid { grid-template-columns: 1fr; }
    footer { padding: 24px 20px; }
  }
</style>
</head>
<body>

<nav>
  <a href="index.html" class="logo">Spon<span>Score</span></a>
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="search.html" class="active">Search</a></li>
    <li><a href="https://chromewebstore.google.com/detail/kopcmglaaaidknoacekcoldaebeigcaa?utm_source=item-share-cb" target="_blank" class="btn-nav">Add to Chrome ‚Üí</a></li>
  </ul>
</nav>

<main>
  <div class="search-hero">
    <div class="badge">üîç Company Lookup</div>
    <h1>Search Any Company</h1>
    <p>Look up H-1B and OPT scores for any employer instantly.</p>
  </div>

  <div class="search-box">
    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></svg>
    <input
      type="text"
      class="search-input"
      id="searchInput"
      placeholder="e.g. Google, Microsoft, Infosys..."
      autocomplete="off"
    />
    <button class="search-btn" id="searchBtn" onclick="doSearch()">Search</button>
  </div>

  <div class="suggestions">
    <div class="suggestion-pill" onclick="searchCompany('Google')">Google</div>
    <div class="suggestion-pill" onclick="searchCompany('Microsoft')">Microsoft</div>
    <div class="suggestion-pill" onclick="searchCompany('Amazon')">Amazon</div>
    <div class="suggestion-pill" onclick="searchCompany('Meta')">Meta</div>
    <div class="suggestion-pill" onclick="searchCompany('Infosys')">Infosys</div>
    <div class="suggestion-pill" onclick="searchCompany('Apple')">Apple</div>
  </div>

  <!-- LOADING -->
  <div class="state" id="stateLoading">
    <div class="loading">
      <div class="spinner"></div>
      <p>Looking up company...</p>
    </div>
  </div>

  <!-- RESULT -->
  <div class="state" id="stateResult">
    <div class="result-card">
      <div class="result-header">
        <div class="company-avatar" id="companyAvatar">G</div>
        <div class="company-info">
          <div class="company-name" id="companyName">Google</div>
          <div class="company-match">
            <span class="check">‚úì</span>
            <span id="matchedKey">Matched: google</span>
          </div>
        </div>
      </div>

      <div class="scores-grid">
        <div class="score-block h1b">
          <div class="score-block-label">H-1B Score</div>
          <div class="score-number high" id="h1bScore">92</div>
          <div class="tier-badge high" id="h1bTier">‚óè High</div>
        </div>
        <div class="score-block opt">
          <div class="score-block-label">OPT Score</div>
          <div class="score-number high" id="optScore">87</div>
          <div class="tier-badge high" id="optTier">‚óè High</div>
        </div>
      </div>

      <div class="workers-grid">
        <div class="worker-block">
          <div class="worker-label">Workers (3yr)</div>
          <div class="worker-value" id="workers3yr">8,200 <span>total</span></div>
        </div>
        <div class="worker-block">
          <div class="worker-label">Workers (5yr)</div>
          <div class="worker-value" id="workers5yr">12,450 <span>total</span></div>
        </div>
      </div>
    </div>
  </div>

  <!-- NOT FOUND -->
  <div class="state" id="stateNotFound">
    <div class="not-found">
      <div class="icon">üîé</div>
      <h3>Company not found</h3>
      <p>We couldn't find a match for that company. Try a different spelling or a parent company name.</p>
    </div>
  </div>

  <!-- ERROR -->
  <div class="state" id="stateError">
    <div class="error-state">
      <div class="icon">‚ö†Ô∏è</div>
      <h3>Something went wrong</h3>
      <p>Couldn't reach the SponScore API. Please try again in a moment.</p>
    </div>
  </div>
</main>

<footer>
  <a href="index.html" class="logo" style="font-size:1.1rem; font-family:'Syne',sans-serif; font-weight:800;">Spon<span style="color:var(--accent);">Score</span></a>
  <p>Built for international job seekers üåç</p>
  <div style="display:flex;gap:24px;">
    <a href="https://sites.google.com/view/sponscore" target="_blank">Privacy Policy</a>
    <a href="mailto:sponscoreapp@gmail.com">Contact</a>
  </div>
</footer>

<script>
  const API = 'https://sponscore.onrender.com';

  function getTierClass(tier) {
    if (!tier) return 'low';
    const t = tier.toLowerCase();
    if (t === 'high') return 'high';
    if (t === 'medium' || t === 'med') return 'med';
    return 'low';
  }

  function getTierLabel(tier) {
    if (!tier) return 'Low';
    const t = tier.toLowerCase();
    if (t === 'high') return '‚óè High';
    if (t === 'medium' || t === 'med') return '‚óè Medium';
    return '‚óè Low';
  }

  function formatNumber(n) {
    if (!n && n !== 0) return '‚Äî';
    return n.toLocaleString();
  }

  function setState(id) {
    document.querySelectorAll('.state').forEach(el => el.classList.remove('active'));
    if (id) document.getElementById(id).classList.add('active');
  }

  async function searchCompany(name) {
    document.getElementById('searchInput').value = name;
    await doSearch();
  }

  async function doSearch() {
    const input = document.getElementById('searchInput').value.trim();
    if (!input) return;

    const btn = document.getElementById('searchBtn');
    btn.disabled = true;
    btn.textContent = '...';
    setState('stateLoading');

    try {
      const res = await fetch(`${API}/company/${encodeURIComponent(input)}`);
      const data = await res.json();

      if (data.error || !data.company) {
        setState('stateNotFound');
      } else {
        // Populate result
        const name = data.company;
        document.getElementById('companyAvatar').textContent = name.charAt(0).toUpperCase();
        document.getElementById('companyName').textContent = name.replace(/\b\w/g, c => c.toUpperCase());
        document.getElementById('matchedKey').textContent = `Matched: ${name}`;

        const h1bClass = getTierClass(data.h1b_tier);
        document.getElementById('h1bScore').textContent = data.h1b_score ?? '‚Äî';
        document.getElementById('h1bScore').className = `score-number ${h1bClass}`;
        document.getElementById('h1bTier').textContent = getTierLabel(data.h1b_tier);
        document.getElementById('h1bTier').className = `tier-badge ${h1bClass}`;

        const optClass = getTierClass(data.opt_tier);
        document.getElementById('optScore').textContent = data.opt_score ?? '‚Äî';
        document.getElementById('optScore').className = `score-number ${optClass}`;
        document.getElementById('optTier').textContent = getTierLabel(data.opt_tier);
        document.getElementById('optTier').className = `tier-badge ${optClass}`;

        document.getElementById('workers3yr').innerHTML = `${formatNumber(data.total_workers_3yr)} <span>total</span>`;
        document.getElementById('workers5yr').innerHTML = `${formatNumber(data.total_workers_5yr)} <span>total</span>`;

        setState('stateResult');
      }
    } catch (e) {
      setState('stateError');
    } finally {
      btn.disabled = false;
      btn.textContent = 'Search';
    }
  }

  // Enter key support
  document.getElementById('searchInput').addEventListener('keydown', e => {
    if (e.key === 'Enter') doSearch();
  });
</script>
</body>
</html>
